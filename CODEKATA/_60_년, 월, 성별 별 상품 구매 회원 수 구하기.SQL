SELECT
    DATE_FORMAT(SALES_DATE, "%Y") AS YEAR,
    DATE_FORMAT(SALES_DATE, "%m") AS MONTH,
    GENDER,
    COUNT(DISTINCT I.USER_ID) AS USERS
FROM
    USER_INFO AS I
    JOIN
    ONLINE_SALE AS S
ON
    I.USER_ID = S.USER_ID
WHERE
    GENDER IS NOT NULL
GROUP BY
    DATE_FORMAT(SALES_DATE, "%Y"),
    DATE_FORMAT(SALES_DATE, "%m"),
    GENDER
ORDER BY
    YEAR,
    MONTH,
    GENDER