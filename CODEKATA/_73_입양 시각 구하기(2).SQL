WITH RECURSIVE TIME AS(
    SELECT 0 AS HOUR
    UNION ALL
    SELECT HOUR + 1
    FROM TIME
    WHERE HOUR < 23
)

SELECT T.HOUR, COUNT(ANIMAL_ID) AS COUNT
FROM TIME AS T
LEFT JOIN ANIMAL_OUTS AS O
ON T.HOUR = HOUR(O.DATETIME)
GROUP BY 1
ORDER BY 1
